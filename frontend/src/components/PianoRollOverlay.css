/* src/components/PianoRollOverlay.css */

/* --- 1. å±€éƒ¨å˜é‡å®šä¹‰ (åªä½œç”¨äºæ­¤ç»„ä»¶) --- */
.piano-roll-container {
  /* åŸºç¡€éŸ³ç¬¦è‰² (ä¿æŒä¸å˜) */
  --note-cyan: #00f3ff;
  --note-magenta: #d946ef;

  /* ğŸ†• å¾®è°ƒåçš„èŠ‚å¥è‰² (Rhythm Colors) */
  /* Steady: åç»¿çš„è–„è·è‰²ï¼Œä¸ Standard çš„é’è‰²åŒºåˆ†å¼€ */
  --rh-steady: #00ffa3; 
  --rh-steady-bg: rgba(0, 255, 163, 0.15);

  /* Slow: æ·±ç»¯çº¢ï¼Œæ¯”çº¯çº¢æ›´æœ‰è´¨æ„Ÿ */
  --rh-slow: #f50057;   
  --rh-slow-bg: rgba(245, 0, 87, 0.15);

  /* Fast: æ—¥è€€æ©™ï¼Œä»£è¡¨â€œè¿‡çƒ­/è¿‡å¿«â€ */
  --rh-fast: #ff9100;   
  --rh-fast-bg: rgba(255, 145, 0, 0.15);

  margin-top: 50px;
  position: relative;
  font-family: 'Orbitron', sans-serif;
}

/* --- 2. å¤´éƒ¨ä¸å›¾ä¾‹ --- */
.piano-roll-header {
  display: flex; justify-content: space-between; align-items: center;
  margin-bottom: 15px;
  border-bottom: 1px solid rgba(255,255,255,0.1);
  padding-bottom: 10px;
}

.piano-roll-header h3 {
  color: #fff; 
  text-shadow: 0 0 10px rgba(167, 139, 250, 0.6);
  font-size: 1.1rem;
  letter-spacing: 2px;
  margin: 0;
}

.legend {
  display: flex; gap: 15px;
  background: rgba(0, 0, 0, 0.3); 
  padding: 6px 18px; 
  border-radius: 4px; /* ç¡¬æœ—åœ†è§’ */
  border: 1px solid rgba(255,255,255,0.08);
  backdrop-filter: blur(5px);
}
.legend-item { display: flex; align-items: center; font-size: 10px; color: rgba(255,255,255,0.7); letter-spacing: 1px;}
.legend-divider { color: rgba(255,255,255,0.2); font-size: 12px; margin: 0 5px; }

/* å›¾ä¾‹ç‚¹æ ·å¼ */
.dot { width: 6px; height: 6px; margin-right: 8px; box-shadow: 0 0 8px currentColor; }
.dot.sample-dot { background: var(--note-cyan); color: var(--note-cyan); }
.dot.practice-dot { background: var(--note-magenta); color: var(--note-magenta); }

/* èŠ‚å¥å›¾ä¾‹å— (ç©ºå¿ƒæ ·å¼æ›´é«˜çº§) */
.rhythm-neon-box { width: 6px; height: 6px; margin-right: 8px; border: 1px solid; background: transparent; box-shadow: 0 0 5px currentColor; }
.rhythm-neon-box.slow { border-color: var(--rh-slow); color: var(--rh-slow); }
.rhythm-neon-box.steady { border-color: var(--rh-steady); color: var(--rh-steady); }
.rhythm-neon-box.fast { border-color: var(--rh-fast); color: var(--rh-fast); }


/* --- 3. æ ¸å¿ƒæ»šåŠ¨åŒºåŸŸ (DAW Wrapper) --- */
.daw-wrapper {
  width: 100%; height: 480px;
  overflow-x: auto; overflow-y: hidden; position: relative;
  /* èƒŒæ™¯æ”¹ä¸ºææ·±çš„ç´«ç½—å…°é»‘ï¼Œä¸é¡µé¢èƒŒæ™¯èåˆ */
  background: #080512; 
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 6px;
  box-shadow: inset 0 0 60px rgba(0,0,0,0.8);
  
  /* å¢åŠ å…¨æ¯æ‰«æçº¿èƒŒæ™¯çº¹ç† */
  background-image: 
    linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
  background-size: 40px 40px;
}

/* --- 4. éŸ³ç¬¦ç½‘æ ¼ä¸æ ·å¼ --- */
.grid-row {
  position: absolute; left: 0; right: 0; width: 100%;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  display: flex; align-items: center; padding-left: 8px;
}
.black-key { background: rgba(255,255,255,0.02); }
.key-label { font-size: 9px; color: rgba(255,255,255,0.2); font-family: 'Orbitron'; pointer-events: none; }

.grid-vertical-line {
  position: absolute; top: 0; bottom: 0; width: 1px;
  background: rgba(255, 255, 255, 0.05); pointer-events: none;
}
.time-label { position: absolute; top: 2px; left: 4px; font-size: 9px; color: rgba(255,255,255,0.3); font-family: 'Orbitron'; }


/* --- 5. éŸ³ç¬¦å— (Neon Blocks) --- */
/* è¿™é‡Œä½¿ç”¨äº†ä¹‹å‰çš„é¢œè‰²ï¼Œä¿æŒé«˜äº® */
.note-block {
  position: absolute; border-radius: 2px;
  display: flex; align-items: center; justify-content: center;
  border: 1px solid;
  backdrop-filter: blur(2px);
}

/* Standard: Cyan */
.note-block.sample {
  border-color: var(--note-cyan);
  background: rgba(0, 243, 255, 0.1);
  box-shadow: 0 0 5px rgba(0, 243, 255, 0.2);
  z-index: 2;
}
.note-block.sample.active-glow {
  background: var(--note-cyan);
  box-shadow: 0 0 20px var(--note-cyan); 
  z-index: 50;
}

/* Practice: Magenta */
.note-block.practice {
  border-color: var(--note-magenta);
  background: rgba(217, 70, 239, 0.1);
  box-shadow: 0 0 5px rgba(217, 70, 239, 0.2);
  z-index: 10;
}
.note-block.practice.active-glow {
  background: var(--note-magenta);
  box-shadow: 0 0 20px var(--note-magenta); 
  z-index: 51;
}

.note-text { display: none; } 

/* æ’­æ”¾å¤´ */
.playhead {
  position: absolute; top: 0; bottom: 0; width: 1px;
  background: #fff;
  z-index: 100; pointer-events: none;
  box-shadow: 0 0 15px #fff;
}
.playhead-cap {
  width: 0; height: 0; position: absolute; left: -4px; top: 0;
  border-left: 5px solid transparent; border-right: 5px solid transparent;
  border-top: 6px solid #fff;
}


/* --- 6. èŠ‚å¥æ—¶é—´è½´ (Visual Upgrade) --- */

.rhythm-separator-title {
  position: absolute; left: 12px;
  font-family: 'Orbitron'; font-size: 9px; color: rgba(255,255,255,0.3);
  letter-spacing: 2px; pointer-events: none;
  text-transform: uppercase;
}

.rhythm-track-container {
  position: absolute; left: 0;
  /* è½¨é“èƒŒæ™¯æ›´æ·±ï¼Œçªå‡ºå‰æ™¯å— */
  background: rgba(0,0,0,0.6);
  border-top: 1px solid rgba(255,255,255,0.08);
  border-bottom: 1px solid rgba(255,255,255,0.08);
}

/* èŠ‚å¥å—ï¼šå¢åŠ çº¹ç†ï¼Œä¸å†æ˜¯çº¯è‰² */
.rhythm-block {
  position: absolute; top: 6px; bottom: 6px;
  display: flex; align-items: center; justify-content: center;
  border-radius: 2px;
  transition: 0.2s;
  
  /* æ ¸å¿ƒï¼šä½¿ç”¨æ¡çº¹çº¹ç†æ¨¡æ‹Ÿæ•°æ®æµ */
  background-image: repeating-linear-gradient(
    90deg,
    transparent 0px,
    transparent 2px,
    rgba(0,0,0,0.5) 3px
  );
  
  /* åº•éƒ¨äº®æ¡ï¼Œæ¨¡æ‹Ÿè¿›åº¦æ¡æ„Ÿ */
  border-bottom: 2px solid;
  border-top: 0; border-left: 0; border-right: 0;
}

/* ğŸŸ¥ Slow (Crimson) */
.rhythm-block.rhythm-slow {
  background-color: var(--rh-slow-bg);
  border-bottom-color: var(--rh-slow);
  color: var(--rh-slow);
  box-shadow: inset 0 -5px 10px rgba(245, 0, 87, 0.2);
}

/* ğŸŸ© Steady (Mint Green) */
.rhythm-block.rhythm-steady {
  background-color: var(--rh-steady-bg);
  border-bottom-color: var(--rh-steady);
  color: var(--rh-steady);
  box-shadow: inset 0 -5px 10px rgba(0, 255, 163, 0.2);
}

/* ğŸŸ§ Fast (Solar Orange) */
.rhythm-block.rhythm-fast {
  background-color: var(--rh-fast-bg);
  border-bottom-color: var(--rh-fast);
  color: var(--rh-fast);
  box-shadow: inset 0 -5px 10px rgba(255, 145, 0, 0.2);
}

/* æ–‡å­—æ ·å¼ï¼šå¾®å¼±å‘å…‰ */
.rhythm-text {
  font-family: 'Orbitron'; font-size: 9px; font-weight: 800;
  letter-spacing: 1px;
  text-shadow: 0 0 8px currentColor;
  opacity: 0.9;
}